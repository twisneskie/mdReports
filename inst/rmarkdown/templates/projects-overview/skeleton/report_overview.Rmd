---
title: "Project Overview Report"
date: "`r format(Sys.time(), '%d %B, %Y')`"
author: "Generated by: `r Sys.getenv('USERNAME')`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

contacts <- get_contacts(data)

```


### All Projects with Metadata

```{r list.projects}
listProjects(data, contacts) %>%
  
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation", 
                                           TRUE),
                colnames = c("Title",
                             "Project Code",
                             "Principal Investigator"))

```

### Types of Data Products
```{r types.of.products}

products <- typesProducts(data)

rows <- nrow(products) - 1

products %>%
  
  knitr::kable(col.names = c("Resource Type",
                             "N")) %>%
  
  kableExtra::kable_styling(full_width = FALSE,
                            position = "left",
                            bootstrap_options = "striped") %>%
  
  kableExtra::row_spec(rows,
                       extra_css = "border-bottom: 2px solid")
```

### All Ongoing Projects
```{r ongoing.projects}
ongoingProjects(data, contacts) %>%
  
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation",
                                               TRUE),
                colnames = c("Title",
                             "Project Code",
                             "Start Date",
                             "End Date",
                             "Principal Investigator"))
```

### Data Management Personnel
Lists required data management personnel for all ongoing projects. Empty cells indicate the role has not been assigned for that project.
```{r dm.personnel}
dmPersonnel(data, contacts) %>%
  
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation",
                                               TRUE),
                colnames = c("Title",
                             "Data Trustee",
                             "Data Steward",
                             "Data Custodian"))
```

