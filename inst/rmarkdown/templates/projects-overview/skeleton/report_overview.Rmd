---
title: "Project Overview Report"
date: "`r format(Sys.time(), '%d %B, %Y')`"
author: "Generated by: `r Sys.getenv('USERNAME')`"
output: 
  html_document:
    theme: spacelab  
  
---

```{r setup, include=FALSE}

knitr::opts_chunk$set(echo = FALSE)

```


## All Projects {.tabset}

### Projects with Metadata
```{r list.projects}
# Filter resources to just products and select title, project name, and contact
# role, if present
dplyr::filter(data,
              data$type == "project") %>%

  dplyr::select(dplyr::any_of(c(Title = "title",
                                "Project Name" = "projectName",
                                "Principal Investigator" = contact_person))) %>%
  
  # Create an interactive table of the results
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation", 
                                           TRUE))

```

### Types of Data Products with Metadata
```{r types.of.products}
# Count the number of each resource type
productTable <- dplyr::filter(data, data$type != "project") %>%
  
  dplyr::select("type") %>%
  
  dplyr::group_by(dplyr::across(c("type"))) %>%
  
  dplyr::count() %>%
  
  dplyr::ungroup()

# Count the number of product types
rows <- nrow(productTable)

# Add a summary row
productTable <- tibble::add_row(productTable,
                                type = "Total",
                                n = sum(productTable$n))

# Create a formatted table to display the results
productTable %>%
  
  knitr::kable(col.names = c("Resource Type",
                             "N")) %>%
  
  kableExtra::kable_styling(full_width = FALSE,
                            position = "left",
                            bootstrap_options = "striped") %>%
  
  kableExtra::row_spec(rows,
                       extra_css = "border-bottom: 2px solid")
```

## Ongoing Projects {.tabset}

### Project Timeline
```{r ongoing.projects}
data %>%

  dplyr::filter(data$type == "project",
                data$status == "onGoing" | data$status =="accepted") %>%

  dplyr::select(dplyr::any_of(c(Title = "title",
                                "Project Name" = "projectName",
                                "Start Date" = "startDate",
                                "End Date" = "endDate",
                                "Maintenance Frequncy" = "frequency"))) %>%
  
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation",
                                               TRUE))
```

### Data Management Personnel
Lists required data management personnel for all ongoing projects. Empty cells indicate the role has not been assigned for that project.
```{r dm.personnel}
data %>%
  
  dplyr::filter(data$type == "project",
                data$status == "onGoing") %>%
  
  dplyr::select(dplyr::any_of(c("title",
                                essential_personnel))) %>%
  
  DT::datatable(filter = "top",
                options = list(pageLength = 5,
                               lengthMenu = c(5, 10, 15, 20)),
                autoHideNavigation = getOption("DT.autoHideNavigation",
                                               TRUE),
                colnames = c("Title",
                             "Data Trustee",
                             "Data Steward",
                             "Data Custodian"))
```

